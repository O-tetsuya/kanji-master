<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Êº¢Â≠ó„Éû„Çπ„Çø„Éº">
    <title>Êº¢Â≠ó„Éû„Çπ„Çø„Éº - Â∞èÂ≠¶3Âπ¥Áîü</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            width: 100%;
        }
        .header {
            background: white;
            border-radius: 24px 24px 0 0;
            padding: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .title h1 {
            color: #7c3aed;
            font-size: 28px;
        }
        .stars {
            background: #fef3c7;
            padding: 8px 16px;
            border-radius: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 20px;
            font-weight: bold;
            color: #b45309;
        }
        .main {
            background: white;
            padding: 32px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .instructions {
            text-align: center;
            margin-bottom: 24px;
        }
        .instructions p {
            color: #7c3aed;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        .instructions small {
            color: #6b7280;
            font-size: 14px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            max-width: 900px;
            margin: 0 auto;
        }
        .box {
            border-radius: 16px;
            padding: 16px;
            position: relative;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            aspect-ratio: 1/1;
            display: flex;
            flex-direction: column;
        }
        .box:hover {
            transform: scale(1.05);
        }
        .box.tall {
            grid-row: span 2;
            aspect-ratio: 1/2;
        }
        .box-label {
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 8px;
        }
        .box-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        .answer {
            font-weight: bold;
            color: white;
            text-align: center;
            padding: 8px;
            word-break: break-all;
        }
        .hint {
            font-weight: bold;
            color: white;
            opacity: 0.2;
            text-align: center;
            padding: 8px;
            word-break: break-all;
        }
        canvas {
            position: absolute;
            inset: 0;
            margin: auto;
            touch-action: none;
            cursor: crosshair;
        }
        .eraser {
            position: absolute;
            top: 8px;
            right: 8px;
            background: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 10;
        }
        .eraser:hover {
            transform: scale(1.1);
        }
        .buttons {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 32px;
        }
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 24px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }
        .btn-clear {
            background: linear-gradient(135deg, #ef4444, #ec4899);
            color: white;
        }
        .btn-answer {
            background: linear-gradient(135deg, #8b5cf6, #3b82f6);
            color: white;
        }
        .footer {
            background: white;
            border-radius: 0 0 24px 24px;
            padding: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 24px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            background: #3b82f6;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        .nav-btn:disabled {
            background: #e5e7eb;
            color: #9ca3af;
            cursor: not-allowed;
        }
        .nav-btn:not(:disabled):hover {
            background: #2563eb;
            transform: scale(1.05);
        }
        .counter {
            font-size: 18px;
            font-weight: bold;
            color: #374151;
        }
        .green { background: linear-gradient(135deg, #86efac, #4ade80); }
        .yellow { background: linear-gradient(135deg, #fde047, #facc15); }
        .blue { background: linear-gradient(135deg, #93c5fd, #60a5fa); }
        .purple { background: linear-gradient(135deg, #c084fc, #a855f7); }
        .orange { background: linear-gradient(135deg, #fdba74, #fb923c); }
        .green-light { background: linear-gradient(135deg, #bbf7d0, #86efac); }
        .blue-light { background: linear-gradient(135deg, #bfdbfe, #93c5fd); }
        .text-green { color: #15803d; }
        .text-yellow { color: #a16207; }
        .text-blue { color: #1e40af; }
        .text-purple { color: #6b21a8; }
        .text-orange { color: #c2410c; }
        .size-large { font-size: 72px; }
        .size-medium { font-size: 32px; }
        .size-small { font-size: 16px; line-height: 1.5; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">
                <span style="font-size: 32px;">üìö</span>
                <h1>Êº¢Â≠ó„Éû„Çπ„Çø„Éº</h1>
            </div>
            <div class="stars">
                <span>‚≠ê</span>
                <span id="starCount">0</span>
            </div>
        </div>

        <div class="main">
            <div class="instructions">
                <p>Áúü„Çì‰∏≠„ÅÆÊº¢Â≠ó„ÇíË¶ã„Å¶„ÄÅ„Åæ„Çè„Çä„ÅÆ„Éû„Çπ„Å´Êõ∏„ÅÑ„Å¶„Åø„Çà„ÅÜÔºÅ</p>
                <small>Âè≥‰∏ä„ÅÆÊ∂à„Åó„Ç¥„É†„Éû„Éº„ÇØ„ÅßÊ∂à„Åõ„Çã„Çà</small>
            </div>

            <div class="grid" id="grid"></div>

            <div class="buttons">
                <button class="btn btn-clear" onclick="clearAll()">
                    <span>üóëÔ∏è</span>
                    <span>ÂÖ®ÈÉ®Ê∂à„Åô</span>
                </button>
                <button class="btn btn-answer" onclick="toggleAnswer()">
                    <span id="eyeIcon">üëÅÔ∏è</span>
                    <span id="answerText">Á≠î„Åà„ÇíË¶ã„ÇãÔºÅ</span>
                </button>
            </div>
        </div>

        <div class="footer">
            <button class="nav-btn" id="prevBtn" onclick="prevKanji()">
                <span>‚óÄ</span>
                <span>„Åæ„Åà„Å∏</span>
            </button>
            <div class="counter" id="counter">1 / 30</div>
            <button class="nav-btn" id="nextBtn" onclick="nextKanji()">
                <span>„Å§„Åé„Å∏</span>
                <span>‚ñ∂</span>
            </button>
        </div>
    </div>

    <script>
        const kanjiData = [
            { kanji: 'Ë©©', bushu: 'Ë®ÄÔºà„Åî„Çì„Åπ„ÇìÔºâ', kakusu: '13Áîª', onyomi: '„Ç∑', onyomiExample: 'Ë©©„ÇíË™≠„Çì„ÅßÊ•Ω„Åó„Åø„Åæ„Åó„Åü„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'Ëëâ', bushu: 'ËâπÔºà„Åè„Åï„Åã„Çì„ÇÄ„ÇäÔºâ', kakusu: '12Áîª', onyomi: '„É®„Ç¶', onyomiExample: 'Ê§çÁâ©„ÅÆËëâ„ÇíÈõÜ„ÇÅ„Å¶Ë™ø„Åπ„Åæ„Åó„Åü„ÄÇ', kunyomi: '„ÅØ', kunyomiExample: 'Áßã„Å´„Å™„Çã„Å®„ÄÅÊú®„ÅÆËëâ„ÅåËµ§„ÅèËâ≤„Å•„Åç„Åæ„Åô„ÄÇ' },
            { kanji: 'Áøí', bushu: 'ÁæΩÔºà„ÅØ„Å≠Ôºâ', kakusu: '11Áîª', onyomi: '„Ç∑„É•„Ç¶', onyomiExample: 'ÊØéÊó•Â≠¶Áøí„Çí„Åå„Çì„Å∞„Çä„Åæ„Åô„ÄÇ', kunyomi: '„Å™„Çâ(„ÅÜ)', kunyomiExample: '„Éî„Ç¢„Éé„ÇíÁøí„Å£„Å¶‰∏äÊâã„Å´„Å™„Çä„Åü„ÅÑ„Åß„Åô„ÄÇ' },
            { kanji: 'Áôª', bushu: 'Áô∂Ôºà„ÅØ„Å§„Åå„Åó„ÇâÔºâ', kakusu: '12Áîª', onyomi: '„Éà„Ç¶', onyomiExample: 'Â±±Áôª„Çä„Çí„Åó„Å¶„ÄÅÂ∫É„ÅÑ‰∏ñÁïå„ÇíË¶ã„Åæ„Åó„Åü„ÄÇ', kunyomi: '„ÅÆ„Åº(„Çã)', kunyomiExample: 'Èöé„Å†„Çì„ÇíÁôª„Å£„Å¶Â±ã‰∏ä„Å´Ë°å„Åç„Åæ„Åó„Åü„ÄÇ' },
            { kanji: 'Áâ©', bushu: 'ÁâõÔºà„ÅÜ„ÅóÔºâ', kakusu: '8Áîª', onyomi: '„Éñ„ÉÑ', onyomiExample: 'ÂãïÁâ©Âúí„Åß„Åü„Åè„Åï„Çì„ÅÆÂãïÁâ©„ÇíË¶ã„Åæ„Åó„Åü„ÄÇ', kunyomi: '„ÇÇ„ÅÆ', kunyomiExample: 'ÈÉ®Â±ã„Å´„ÅÇ„Çã„ÇÇ„ÅÆ„ÇíÂÖ®ÈÉ®„Åã„Åü„Å•„Åë„Åæ„Åó„Åü„ÄÇ' },
            { kanji: 'ÂïÜ', bushu: 'Âè£Ôºà„Åè„Å°Ôºâ', kakusu: '11Áîª', onyomi: '„Ç∑„Éß„Ç¶', onyomiExample: 'ÂïÜÂ∫ó„Åß„ÅäË≤∑„ÅÑÁâ©„Çí„Åó„Åæ„Åó„Åü„ÄÇ', kunyomi: '„ÅÇ„Åç„Å™(„ÅÜ)', kunyomiExample: '„ÅäÂ∫ó„ÅßÂïÜ„ÅÑ„Çí„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ' },
            { kanji: 'È§®', bushu: 'È£üÔºà„Åó„Çá„ÅèÔºâ', kakusu: '16Áîª', onyomi: '„Ç´„É≥', onyomiExample: 'Âõ≥Êõ∏È§®„ÅßÊú¨„Çí„Åã„Çä„Å¶Ë™≠„Åø„Åæ„Åó„Åü„ÄÇ', kunyomi: '„ÇÑ„Åã„Åü', kunyomiExample: 'Âè§„ÅÑ„ÇÑ„Åã„Åü„ÇíË¶ã„Å´Ë°å„Åç„Åæ„Åó„Åü„ÄÇ' },
            { kanji: 'Èñã', bushu: 'ÈñÄÔºà„ÇÇ„Çì„Åå„Åæ„ÅàÔºâ', kakusu: '12Áîª', onyomi: '„Ç´„Ç§', onyomiExample: 'ÈÅãÂãï‰ºö„ÅÆÈñã‰ºöÂºè„Åß„ÅÇ„ÅÑ„Åï„Å§„Åó„Åæ„Åó„Åü„ÄÇ', kunyomi: '„Å≤„Çâ(„Åè)', kunyomiExample: '„Éâ„Ç¢„ÇíÈñã„Åë„Çã„Å®„ÄÅÊòé„Çã„Åè„Å™„Çä„Åæ„Åó„Åü„ÄÇ' },
            { kanji: 'Âãï', bushu: 'ÂäõÔºà„Å°„Åã„ÇâÔºâ', kakusu: '11Áîª', onyomi: '„Éâ„Ç¶', onyomiExample: 'ÈÅãÂãï„Çí„Åô„Çã„Å®‰Ωì„ÅåÂÖÉÊ∞ó„Å´„Å™„Çä„Åæ„Åô„ÄÇ', kunyomi: '„ÅÜ„Åî(„Åè)', kunyomiExample: 'Ëªä„ÅåÂãï„ÅÑ„Å¶Ëµ∞„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ' },
            { kanji: 'Âßã', bushu: 'Â•≥Ôºà„Åä„Çì„Å™Ôºâ', kakusu: '8Áîª', onyomi: '„Ç∑', onyomiExample: '„Åò„ÇÖÊ•≠„ÅÆÂßã„Åæ„Çä„ÅÆÊôÇÈñì„ÇíÂÆà„Çä„Åæ„Åô„ÄÇ', kunyomi: '„ÅØ„Åò(„ÇÅ„Çã)', kunyomiExample: '‰ªäÊó•„Åã„ÇâÊñ∞„Åó„ÅÑ„Åì„Å®„ÇíÂßã„ÇÅ„Åæ„Åô„ÄÇ' },
            { kanji: 'Ëæû', bushu: 'ËæõÔºà„Åã„Çâ„ÅÑÔºâ', kakusu: '13Áîª', onyomi: '„Ç∏', onyomiExample: 'ÂõΩË™ûËæû„Å¶„Çì„ÅßÊÑèÂë≥„ÇíË™ø„Åπ„Åæ„Åô„ÄÇ', kunyomi: '„ÇÑ(„ÇÅ„Çã)', kunyomiExample: 'Âè§„ÅÑ‰ªï‰∫ã„Çí„ÇÑ„ÇÅ„Å¶Êñ∞„Åó„ÅÑ‰ªï‰∫ã„Çí„Åó„Åæ„Åô„ÄÇ' },
            { kanji: 'Ë™ø', bushu: 'Ë®ÄÔºà„Åî„Çì„Åπ„ÇìÔºâ', kakusu: '15Áîª', onyomi: '„ÉÅ„Éß„Ç¶', onyomiExample: 'Âõ≥Êõ∏È§®„ÅßË™ø„ÅπÂ≠¶Áøí„Çí„Åó„Åæ„Åó„Åü„ÄÇ', kunyomi: '„Åó„Çâ(„Åπ„Çã)', kunyomiExample: 'ÂàÜ„Åã„Çâ„Å™„ÅÑ„Åì„Å®„ÇíË™ø„Åπ„Åæ„Åô„ÄÇ' },
            { kanji: 'Áî±', bushu: 'Áî∞Ôºà„ÅüÔºâ', kakusu: '5Áîª', onyomi: '„É¶„Ç¶', onyomiExample: '„Åä„Åè„Çå„ÅüÁêÜÁî±„ÇíË©±„Åó„Åæ„Åó„Åü„ÄÇ', kunyomi: '„Çà„Åó', kunyomiExample: 'ÂêçÂâç„ÅÆ„ÇÜÊù•„ÇíË™ø„Åπ„Åæ„Åó„Åü„ÄÇ' },
            { kanji: 'ÊÑè', bushu: 'ÂøÉÔºà„Åì„Åì„ÇçÔºâ', kakusu: '13Áîª', onyomi: '„Ç§', onyomiExample: 'Âèã„Å†„Å°„ÅÆÊÑèË¶ã„ÇíËÅû„ÅÑ„Å¶ËÄÉ„Åà„Åæ„Åó„Åü„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'Âë≥', bushu: 'Âè£Ôºà„Åè„Å°Ôºâ', kakusu: '8Áîª', onyomi: '„Éü', onyomiExample: '„Åì„ÅÆ„Ç±„Éº„Ç≠„ÅØ„ÅÇ„Åæ„ÅÑÂë≥„Åå„Åó„Åæ„Åô„ÄÇ', kunyomi: '„ÅÇ„Åò', kunyomiExample: '„ÅäÊØç„Åï„Çì„ÅÆ‰Ωú„Å£„ÅüÁâ©„ÅÆÂë≥„ÅØ„Åï„ÅÑÈ´ò„Åß„Åô„ÄÇ' },
            { kanji: '‰ºù', bushu: '‰∫∫Ôºà„Å´„Çì„Åπ„ÇìÔºâ', kakusu: '6Áîª', onyomi: '„Éá„É≥', onyomiExample: '‰ºùË®Ä„ÇíÂèã„Å†„Å°„Å´‰ºù„Åà„Åæ„Åó„Åü„ÄÇ', kunyomi: '„Å§„Åü(„Åà„Çã)', kunyomiExample: 'Â§ßÂàá„Å™„Åì„Å®„ÇíÂÆ∂„Åû„Åè„Å´‰ºù„Åà„Åæ„Åô„ÄÇ' },
            { kanji: 'ÈâÑ', bushu: 'ÈáëÔºà„Åã„Å≠„Å∏„ÇìÔºâ', kakusu: '13Áîª', onyomi: '„ÉÜ„ÉÑ', onyomiExample: 'ÈâÑÈÅì„Å´‰πó„Å£„Å¶ÊóÖË°å„Åó„Åæ„Åó„Åü„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'ÈÉ®', bushu: 'ÈÇëÔºà„Åä„Åä„Åñ„Å®Ôºâ', kakusu: '11Áîª', onyomi: '„Éñ', onyomiExample: '„Çµ„ÉÉ„Ç´„ÉºÈÉ®„ÅßÊØéÊó•„Çå„ÇìÁøí„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'ÈÖç', bushu: 'ÈÖâÔºà„Å®„Çä„Å∏„ÇìÔºâ', kakusu: '10Áîª', onyomi: '„Éè„Ç§', onyomiExample: 'Êñ∞ËÅûÈÖç„Åü„Å§„ÅÆ‰∫∫„ÅåÊù•„Åæ„Åó„Åü„ÄÇ', kunyomi: '„Åè„Å∞(„Çã)', kunyomiExample: '„Éó„É™„É≥„Éà„ÇíÈÖç„Å£„Å¶„ÄÅ„Åø„Çì„Å™„Å´„Çè„Åü„Åó„Åæ„Åó„Åü„ÄÇ' },
            { kanji: 'ÂÖ®', bushu: '‰∫∫Ôºà„Å≤„Å®Ôºâ', kakusu: '6Áîª', onyomi: '„Çº„É≥', onyomiExample: 'ÂÆâÂÖ®„Å´Ê∞ó„Çí„Å§„Åë„Å¶ÈÅì„Çí„Çè„Åü„Çä„Åæ„Åô„ÄÇ', kunyomi: '„Åæ„Å£„Åü(„Åè)', kunyomiExample: '„Åó„ÇÖ„Åè„Å†„ÅÑ„ÇíÂÖ®„Åè„ÇÑ„Å£„Å¶„ÅÑ„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ' },
            { kanji: 'Ë´á', bushu: 'Ë®ÄÔºà„Åî„Çì„Åπ„ÇìÔºâ', kakusu: '15Áîª', onyomi: '„ÉÄ„É≥', onyomiExample: 'ÂÖàÁîü„Å®„Åù„ÅÜË´á„Åó„Å¶„ÄÅ„Åç„ÇÅ„Åæ„Åó„Åü„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'Á∑ë', bushu: 'Á≥∏Ôºà„ÅÑ„Å®„Å∏„ÇìÔºâ', kakusu: '14Áîª', onyomi: '„É™„Éß„ÇØ', onyomiExample: 'Á∑ëËâ≤„ÅÆËëâ„Å£„Å±„Åå„Åü„Åè„Åï„Çì„ÅÇ„Çä„Åæ„Åô„ÄÇ', kunyomi: '„Åø„Å©„Çä', kunyomiExample: 'Êò•„Å´„Å™„Çã„Å®„ÄÅÁ∑ë„Åå„Åç„Çå„ÅÑ„Åß„Åô„ÄÇ' },
            { kanji: 'Ê∑±', bushu: 'Ê∞¥Ôºà„Åï„Çì„Åö„ÅÑÔºâ', kakusu: '11Áîª', onyomi: '„Ç∑„É≥', onyomiExample: 'Ê∑±Â§ú„Åæ„Åß„Åä„Åç„Å¶„ÅÑ„Åü„ÅÆ„Åß„ÄÅ„Å≠„ÇÄ„ÅÑ„Åß„Åô„ÄÇ', kunyomi: '„Åµ„Åã(„ÅÑ)', kunyomiExample: '„Åì„ÅÆ„Éó„Éº„É´„ÅØÊ∑±„ÅÑ„ÅÆ„ÅßÊ∞ó„Çí„Å§„Åë„Åæ„Åô„ÄÇ' },
            { kanji: 'ÊÑü', bushu: 'ÂøÉÔºà„Åì„Åì„ÇçÔºâ', kakusu: '13Áîª', onyomi: '„Ç´„É≥', onyomiExample: '„Åà„ÅÑÁîª„ÇíË¶ã„Å¶„ÄÅÊÑüÂãï„Åó„Åæ„Åó„Åü„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'ÊÉ≥', bushu: 'ÂøÉÔºà„Åì„Åì„ÇçÔºâ', kakusu: '13Áîª', onyomi: '„ÇΩ„Ç¶', onyomiExample: 'Â§è‰ºë„Åø„ÅÆÊÄù„ÅÑÂá∫„Çí‰ΩúÊñá„Å´Êõ∏„Åç„Åæ„Åó„Åü„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'È°å', bushu: 'È†ÅÔºà„Åä„Åä„Åå„ÅÑÔºâ', kakusu: '18Áîª', onyomi: '„ÉÄ„Ç§', onyomiExample: 'ÂïèÈ°å„Åå„ÇÄ„Åö„Åã„Åó„Åè„Å¶„ÄÅ„Å®„Åë„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ', kunyomi: '', kunyomiExample: '' },
            { kanji: 'Ê®™', bushu: 'Êú®Ôºà„Åç„Å∏„ÇìÔºâ', kakusu: '15Áîª', onyomi: '„Ç™„Ç¶', onyomiExample: 'Ê®™„Å†„ÇìÊ≠©ÈÅì„Çí„Çè„Åü„Å£„Å¶Â≠¶Ê†°„Å´Ë°å„Åç„Åæ„Åô„ÄÇ', kunyomi: '„Çà„Åì', kunyomiExample: 'Âèã„Å†„Å°„ÅÆÊ®™„Å´„Åô„Çè„Å£„Å¶„ÄÅË©±„Çí„Åó„Åæ„Åó„Åü„ÄÇ' },
            { kanji: 'ËªΩ', bushu: 'ËªäÔºà„Åè„Çã„Åæ„Å∏„ÇìÔºâ', kakusu: '12Áîª', onyomi: '„Ç±„Ç§', onyomiExample: 'ËªΩ„ÅÑËç∑Áâ©„ÇíÊåÅ„Å£„Å¶Âá∫„Åã„Åë„Åæ„Åó„Åü„ÄÇ', kunyomi: '„Åã„Çã(„ÅÑ)', kunyomiExample: '„Åì„ÅÆ„ÅØ„Åì„ÅØËªΩ„ÅÑ„ÅÆ„Åß„ÄÅ„Åã„Çì„Åü„Çì„Å´ÈÅã„Åπ„Åæ„Åô„ÄÇ' },
            { kanji: 'Èáç', bushu: 'ÈáåÔºà„Åï„Å®Ôºâ', kakusu: '9Áîª', onyomi: '„Ç∏„É•„Ç¶', onyomiExample: 'ÈáçË¶Å„Å™„Åì„Å®„Çí„É°„É¢„Åó„Åæ„Åô„ÄÇ', kunyomi: '„Åä„ÇÇ(„ÅÑ)', kunyomiExample: '„Åì„ÅÆËç∑Áâ©„ÅØÈáç„ÅÑ„ÅÆ„Åß„ÄÅ‰∫å‰∫∫„ÅßÈÅã„Å≥„Åæ„Åô„ÄÇ' },
            { kanji: 'Êúü', bushu: 'ÊúàÔºà„Å§„Åç„Å∏„ÇìÔºâ', kakusu: '12Áîª', onyomi: '„Ç≠', onyomiExample: '‰ªäÊó•„Åã„ÇâÊñ∞Â≠¶Êúü„ÅåÂßã„Åæ„Çä„Åæ„Åô„ÄÇ', kunyomi: '', kunyomiExample: '' }
        ];

        let shuffledData = [...kanjiData].sort(() => Math.random() - 0.5);
        let currentIndex = 0;
        let showAnswer = false;
        let stars = 0;
        let canvases = {};
        let drawing = false;
        let activeCanvas = null;

        function init() {
            renderGrid();
            updateUI();
        }

        function renderGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';

            const boxes = [
                { id: 'kunyomi', label: 'Ë®ìË™≠„Åø', color: 'green', textColor: 'text-green', size: 'medium', content: 'kunyomi' },
                { id: 'bushu', label: 'ÈÉ®È¶ñ', color: 'yellow', textColor: 'text-yellow', size: 'medium', content: 'bushu' },
                { id: 'onyomi', label: 'Èü≥Ë™≠„Åø', color: 'blue', textColor: 'text-blue', size: 'medium', content: 'onyomi' },
                { id: 'kunyomiExample', label: 'Ë®ìË™≠„Åø„ÅÆ‰æãÊñá', color: 'green-light', textColor: 'text-green', size: 'small', content: 'kunyomiExample', tall: true },
                { id: 'kanji', label: '', color: 'purple', textColor: 'text-purple', size: 'large', content: 'kanji', alwaysShow: true },
                { id: 'onyomiExample', label: 'Èü≥Ë™≠„Åø„ÅÆ‰æãÊñá', color: 'blue-light', textColor: 'text-blue', size: 'small', content: 'onyomiExample', tall: true },
                { id: 'kakusu', label: 'ÁîªÊï∞', color: 'orange', textColor: 'text-orange', size: 'medium', content: 'kakusu' }
            ];

            boxes.forEach(box => {
                const boxEl = document.createElement('div');
                boxEl.className = `box ${box.color} ${box.tall ? 'tall' : ''}`;

                const label = document.createElement('div');
                label.className = `box-label ${box.textColor}`;
                label.textContent = box.label;

                const content = document.createElement('div');
                content.className = 'box-content';

                const currentKanji = shuffledData[currentIndex];
                const text = currentKanji[box.content] || '„Å™„Åó';

                if (box.alwaysShow) {
                    const answer = document.createElement('div');
                    answer.className = `answer size-${box.size}`;
                    answer.textContent = text;
                    content.appendChild(answer);
                } else {
                    const answer = document.createElement('div');
                    answer.className = `answer size-${box.size}`;
                    answer.id = `answer-${box.id}`;
                    answer.textContent = text;
                    answer.style.display = showAnswer ? 'block' : 'none';
                    content.appendChild(answer);

                    const hint = document.createElement('div');
                    hint.className = `hint size-${box.size}`;
                    hint.id = `hint-${box.id}`;
                    hint.textContent = text;
                    hint.style.display = showAnswer ? 'none' : 'block';
                    content.appendChild(hint);

                    const canvas = document.createElement('canvas');
                    canvas.width = box.tall ? 280 : 140;
                    canvas.height = box.tall ? 280 : 140;
                    canvas.id = `canvas-${box.id}`;
                    content.appendChild(canvas);
                    canvases[box.id] = canvas;

                    const eraser = document.createElement('button');
                    eraser.className = 'eraser';
                    eraser.textContent = 'üóëÔ∏è';
                    eraser.onclick = () => clearCanvas(box.id);
                    boxEl.appendChild(eraser);

                    setupCanvas(canvas, box.id);
                }

                boxEl.appendChild(label);
                boxEl.appendChild(content);
                grid.appendChild(boxEl);
            });
        }

        function setupCanvas(canvas, id) {
            const ctx = canvas.getContext('2d');
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.lineWidth = 4;
            ctx.strokeStyle = '#333';

            canvas.addEventListener('mousedown', (e) => startDraw(e, id));
            canvas.addEventListener('mousemove', (e) => draw(e, id));
            canvas.addEventListener('mouseup', stopDraw);
            canvas.addEventListener('mouseleave', stopDraw);

            canvas.addEventListener('touchstart', (e) => startDraw(e, id));
            canvas.addEventListener('touchmove', (e) => draw(e, id));
            canvas.addEventListener('touchend', stopDraw);
        }

        function startDraw(e, id) {
            e.preventDefault();
            const canvas = canvases[id];
            const ctx = canvas.getContext('2d');
            const rect = canvas.getBoundingClientRect();

            let x, y;
            if (e.type === 'touchstart') {
                x = e.touches[0].clientX - rect.left;
                y = e.touches[0].clientY - rect.top;
            } else {
                x = e.clientX - rect.left;
                y = e.clientY - rect.top;
            }

            ctx.beginPath();
            ctx.moveTo(x, y);
            drawing = true;
            activeCanvas = id;
        }

        function draw(e, id) {
            if (!drawing || activeCanvas !== id) return;
            e.preventDefault();

            const canvas = canvases[id];
            const ctx = canvas.getContext('2d');
            const rect = canvas.getBoundingClientRect();

            let x, y;
            if (e.type === 'touchmove') {
                x = e.touches[0].clientX - rect.left;
                y = e.touches[0].clientY - rect.top;
            } else {
                x = e.clientX - rect.left;
                y = e.clientY - rect.top;
            }

            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function stopDraw() {
            drawing = false;
            activeCanvas = null;
        }

        function clearCanvas(id) {
            const canvas = canvases[id];
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function clearAll() {
            Object.keys(canvases).forEach(id => clearCanvas(id));
        }

        function toggleAnswer() {
            showAnswer = !showAnswer;
            if (showAnswer) stars++;

            document.querySelectorAll('[id^="answer-"]').forEach(el => {
                el.style.display = showAnswer ? 'block' : 'none';
            });
            document.querySelectorAll('[id^="hint-"]').forEach(el => {
                el.style.display = showAnswer ? 'none' : 'block';
            });

            document.getElementById('answerText').textContent = showAnswer ? 'Á≠î„Åà„ÇíÈö†„Åô' : 'Á≠î„Åà„ÇíË¶ã„ÇãÔºÅ';
            document.getElementById('starCount').textContent = stars;
        }

        function nextKanji() {
            if (currentIndex < shuffledData.length - 1) {
                currentIndex++;
                showAnswer = false;
                clearAll();
                renderGrid();
                updateUI();
            }
        }

        function prevKanji() {
            if (currentIndex > 0) {
                currentIndex--;
                showAnswer = false;
                clearAll();
                renderGrid();
                updateUI();
            }
        }

        function updateUI() {
            document.getElementById('counter').textContent = `${currentIndex + 1} / ${shuffledData.length}`;
            document.getElementById('prevBtn').disabled = currentIndex === 0;
            document.getElementById('nextBtn').disabled = currentIndex === shuffledData.length - 1;
            document.getElementById('starCount').textContent = stars;
        }

        init();
    </script>
</body>
</html>
